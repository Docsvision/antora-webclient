= Коллекционный контрол

Элемент управления `_Коллекционный контрол_` предназначен для выбора одного или нескольких значений из одного или нескольких справочников. Пользователь может выбирать (в зависимости от настроек) сотрудников, организации, подразделения и т.д.

Вариант отображения ЭУ зависит от свойства `*Режим редактирования*`.

== Свойства

include::partial$properties.adoc[tags=general]

=== Внешний вид

==== Заполнитель

Текст, отображаемый в элементе управления, если строка справочника не выбрана.

`*Локализуемый*`

include::partial$properties.adoc[tags=displayLabelWithoutDefinition]

include::partial$properties.adoc[tags=hint]

include::partial$properties.adoc[tags=labelText]

=== Данные

include::partial$properties.adoc[tags=extendedDataSource]

==== Источник данных

Чтобы выбрать источник данных, нажмите кнопку image:buttons/three-dots.png[Три точки]. Будет открыто окно:

.Выбор источника данных для элемента управления
image:directory-designer-data-source.png[Выбор источника данных для элемента управления]

Настройки источника содержат следующие элементы:

"Секция":: Выбор секции с полями со значениями элемента управления. Если к разметке подключены дополнительные источники данных, для выбора будут доступны секции карточки и три дополнительных источника.

Столбец "Доступность выбора":: Регулирует доступность выбора узлов и/или записей справочнике в элементе управления при помощи настроек в полях _Узел_ и _Запись_.
+
--
[[node]]Узел:::
Если указан источник данных для узла, в качестве значения элемента управления можно будет выбрать узел справочника.
--
+
--
Запись:::
Если указан источник данных для записи, в качестве значений ЭУ можно будет выбрать записи справочника.
--
+
Если указаны источники данных для обоих вариантов, в качестве значений можно будет выбирать как узлы, так и записи.

==== Типы значений

Свойство, позволяющее выбрать значения, которые будут доступны для выбора в элементе управления. Чтобы настроить доступность, нажмите на кнопку image:buttons/three-dots.png[Три точки]. Будет открыто окно:

.Окно "Типы значений"
image::collection-types-settings.png[Окно "Типы значений"]

* _Поле данных_ -- поле типа `RefId` со ссылкой на строку карточки справочника, в которое будет сохранено значение данного типа.
* _Справочник_ -- карточка справочника, из которой будет выбираться значение ЭУ данного типа. Если выбрано значение _Справочник контрагентов_, то становятся доступными для редактирования параметры: Редактирование справочника, Узел.
* _Секция справочника_ -- табличная или древовидная секция выбранной карточки справочника, из строк которой будет выбираться значение ЭУ данного типа. Если в параметре _Справочник_ выбрано значение _Справочник контрагентов_, и в текущем параметре выбрано *_Сотрудники_*, становятся доступными для редактирования параметры _Редактирование справочника_ и _Узел_.
* _Ограничение_ -- строковое поле секции справочника, значение которого будет использовано в качестве строки отображения элемента данного типа.
* [[disp-field]]_Отображаемое поле_ -- строковые поля секции справочника, по которым будет осуществляться поиск строки секции (объединяются по ИЛИ) данного типа.
* _Поля для поиска_ -- идентификатор строки секции справочника, которая будет выступать ограничением при поиске строки секции, например, идентификатор подразделения при выборе сотрудников.
+
--
** Если выбрана табличная секция, выбираемые элементы будут ограничены по полю `ParentRowID`.
** Если выбрана древовидная секция, выбираемые элементы будут ограничены по полю `ParentTreeRowID`.
--
+
.Дополнительные поля
image::collection-types-additional.png[Дополнительные поля]
+
[[add-fields]]Дополнительные поля -- список полей и их названий, которые будут отображены в выпадающем списке элементов и форме поиска, выбора элементов и отображения значения. Появившееся окно позволяет добавить необходимое количество дополнительных полей. Для каждого добавленного поля можно задать отображаемое имя Можно выбрать как простые поля, так и ссылочные. Если флаг установлен, значение данного поля отображается в представлении в формате: `Наименование организации, выбранные значения через запятую`.
+
** _Имя плагина для доп. полей_ -- можно указать плагин, который будет использован для получения дополнительных полей кодом. Это будет полезно для получения данных из, например, карточек сотрудников, подразделений, строк конструктора справочников, либо  по какой-либо другой сложной логике.
** _CSS-класс иконки_ -- можно задать css стиль.
** Редактирование справочника -- параметр, который в форме выбора контрагентов отображает кнопку image:user:buttons/add-partner.png[Добавить контрагента]. Поведение, аналогичное кнопке в стандартному ЭУ "xref:layouts:ctrl/directories/partner.adoc[Подразделение контрагента]".
** Узел -- ID узла, в котором должны создаваться новые контрагенты по кнопке image:user:buttons/add-partner.png[Добавить контрагента].

include::partial$properties.adoc[tags=editOperation]

=== Поведение

==== Выбор одного элемента

Позволяет настроить возможность выбора только одну строку справочника.

==== Не показывать недоступные значения

Позволяет настроить возможность выбора строк справочника, помеченных как недоступные для выбора. Если данного отметка для секции справочника отсутствует, данная настройка игнорируется.

[#search-index]
==== Поисковой индекс

Количество символов в текстовом поле, необходимое для начала поиска значений элементом управления.

include::partial$properties.adoc[tags=mandatory]

include::partial$properties.adoc[tags=visibility]

include::partial$properties.adoc[tags=icon]

include::partial$properties.adoc[tags=addCss]

include::partial$properties.adoc[tags=byTab]

include::partial$properties.adoc[tags=editMode]

include::partial$properties.adoc[tags=stdCss]
